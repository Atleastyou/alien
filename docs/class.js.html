<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Source: util/class.js - Alien documents</title>

    <link type="text/css" rel="stylesheet" href="/static/css/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="/static/css/bootstrap-theme.min.css">
    <link type="text/css" rel="stylesheet" href="/static/styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="/static/css/docs.css">
</head>

<body>


<div class="navbar navbar-inverse navbar-fixed-top">
	<div class="container">
	    <div class="navbar-header">
	        <a class="navbar-brand" href="index.html">Alien documents</a>
	    </div>
	    <nav role="navigation">
			<ul class="nav navbar-nav">
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
<ul class="dropdown-menu">
<li><a href="jsonp.html">core/communication/jsonp</a></li>
<li><a href="xhr.html">core/communication/xhr</a></li>
<li><a href="animation.html">core/dom/animation</a></li>
<li><a href="attribute.html">core/dom/attribute</a></li>
<li><a href="modification.html">core/dom/modification</a></li>
<li><a href="selector.html">core/dom/selector</a></li>
<li><a href="base.html">core/event/base</a></li>
<li><a href="drag.html">core/event/drag</a></li>
<li><a href="ready.html">core/event/ready</a></li>
<li><a href="touch.html">core/event/touch</a></li>
<li><a href="wheel.html">core/event/wheel</a></li>
<li><a href="compatible.html">core/navigator/compatible</a></li>
<li><a href="hashbang.html">core/navigator/hashbang</a></li>
<li><a href="querystring.html">core/navigator/querystring</a></li>
<li><a href="shell.html">core/navigator/shell</a></li>
<li><a href="ua.html">core/navigator/ua</a></li>
<li><a href="DDB.html">libs/DDB</a></li>
<li><a href="Deferred.html">libs/Deferred</a></li>
<li><a href="Emitter.html">libs/Emitter</a></li>
<li><a href="Template.html">libs/Template</a></li>
<li><a href="upload.html">parent/upload</a></li>
<li><a href="Banner.html">ui/Banner</a></li>
<li><a href="Dialog.html">ui/Dialog</a></li>
<li><a href="Msg.html">ui/Msg</a></li>
<li><a href="Pagination.html">ui/Pagination</a></li>
<li><a href="Scrollbar.html">ui/Scrollbar</a></li>
<li><a href="Tooltip.html">ui/Tooltip</a></li>
<li><a href="class.html">util/class</a></li>
<li><a href="data.html">util/data</a></li>
<li><a href="date.html">util/date</a></li>
<li><a href="easing.html">util/easing</a></li>
<li><a href="Pagination_.html">util/Pagination</a></li>
<li><a href="Validate.html">util/Validate</a></li>
</ul>
</li>
</ul>

			<ul class="nav navbar-nav navbar-right">
                <li><a href="/">Alien home</a></li>
            </ul>
	    </nav>
  </div>
</div>


<div id="main">


	

	    <div class="main">
	        <nav id="docs-sidebar">
	            

	            <ul class="nav sidebar-list">
	                

	                

	                

	                
	            </ul>
	        </nav>

	        <section id="docs-content">
	            <div class="content">
		            <h1 class="page-title">Source: util/class.js</h1>

		            


    

<pre class="prettyprint source"><code>/*!
 * class.js
 * @author ydr.me
 * @create 2014-10-04 15:09
 */


define(function (require, exports, module) {
    /**
     * 类方法
     * @module util/class
     * @requires util/data
     */
    'use strict';

    var data = require('./data.js');

    module.exports = {
        /**
         * 单继承
         * @param {Function} constructor 子类
         * @param {Function} superConstructor 父类
         * @param {Boolean} [isCopyStatic=false] 是否复制静态方法
         * @link https://github.com/joyent/node/blob/master/lib/util.js#L628
         *
         * @example
         * // 父类
         * var Father = function(){};
         *
         * // 子类
         * var Child = function(){
         *     // 执行一次父类的方法
         *     Father.apply(this, arguments);
         *
         *     // 这里执行子类的方法、属性
         *     this.sth = 123;
         * };
         *
         * klass.inherit(Child, Father);
         *
         * // 这里开始写子类的原型方法
         * Child.prototype = {};
         */
        inherit: function (constructor, superConstructor, isCopyStatic) {
            constructor.super_ = superConstructor;
//            var F = function () {
//                // ignore
//            };
//            F.prototype = new superConstructor();
//            constructor.prototype = new F;
            constructor.prototype = Object.create(superConstructor.prototype, {
                constructor: {
                    value: constructor,
                    // 是否可被枚举
                    enumerable: !1,
                    // 是否可被重写
                    writable: !0,
                    // 是否可被修改
                    configurable: !0
                }
            });

            if (isCopyStatic) {
                data.extend(!0, constructor, superConstructor);
            }
        },
        /**
         * 创建一个类（构造函数）
         * @param {Object} property
         * @param {Function} property.constructor 构造函数
         * @param {Object} [property.STATIC]  静态属性
         * @param {Function} [superConstructor] 父类
         * @param {Boolean} [isInheritStatic] 是否继承父类的静态方法
         *
         * @example
         * var Father = klass.create({
         *     // 构造方法
         *     constructor: function (name) {
         *         this.name = name;
         *     },
         *     // 原型属性及方法
         *     say: function () {
         *         console.log('hi, i am ' + this.name);
         *     },
         *     // 静态属性及方法
         *     STATIC: {
         *         a: 1,
         *         b: 2
         *     }
         * });
         *
         * var Child = klass.create({
         *     // 构造方法
         *     constructor: function (name, age) {
         *         Father.apply(this, arguments);
         *         this.age = age;
         *     },
         *     // 原型属性及方法
         *     speak: function () {
         *         console.log(this.name + ' is ' + this.age);
         *     },
         *     // 静态属性及方法
         *     STATIC:{
         *         c: 3,
         *         d: 4
         *     }
         * }, Father, true);
         *
         * var f1 = new Father('Fimme');
         * var c1 = new Child('Cmoo', 20);
         *
         */
        create: function (property, superConstructor, isInheritStatic) {
            var type = data.type(property);
            var constructorType;
//            var initType;
            var superConstructorType = data.type(superConstructor);
            var STATIC;

            if (type !== 'object') {
                throw new Error('property must be an object');
            }

            // 必须有构造函数
            if (!data.hasOwnProperty(property, 'constructor')) {
                throw new Error('property must be have a `constructor` function');
            }

//            // 必须有初始化方法
//            if (!data.hasOwnProperty(property, 'init')) {
//                throw new Error('property must be have a `init` function');
//            }

            constructorType = data.type(property.constructor);

            if (constructorType !== 'function') {
                throw new Error('property `constructor` must be a function');
            }

//            initType = data.type(property.init);
//
//            if (initType !== 'function') {
//                throw new Error('property `init` must be a function');
//            }

            if (superConstructorType !== 'undefined' &amp;&amp; superConstructorType === 'function') {
                this.inherit(property.constructor, superConstructor, isInheritStatic);
            }

            STATIC = property.STATIC || {};
            delete property.STATIC;

            // 必须静态对象
            if (data.type(STATIC) !== 'object') {
                throw new Error('constructor static property must be an object');
            }

            // 不能重写静态`super_`属性，保留字段
            if (STATIC.super_) {
                throw new Error('unable to rewrite constructor static property super_ value');
            }

            // 添加静态方法、属性
            data.each(STATIC, function (key, val) {
                if (key !== 'prototype') {
                    property.constructor[key] = val;
                }
            });

            // 添加原型链方法、属性
            data.each(property, function (key, val) {
                property.constructor.prototype[key] = val;
            });

            // 添加默认方法
            if (property.constructor.prototype.getOptions === undefined) {
                property.constructor.prototype.getOptions = function (key) {
                    var the = this;
                    var keyType = data.type(key);
                    var ret = [];

                    if (keyType === 'string' || keyType === 'number') {
                        return the._options[key];
                    } else if (keyType === 'array') {
                        data.each(key, function (index, k) {
                            ret.push(the._options[k]);
                        });

                        return ret;
                    }
                };
            }

            if (property.constructor.prototype.setOptions === undefined) {
                property.constructor.prototype.setOptions = function (key, val) {
                    var the = this;
                    var keyType = data.type(key);

                    if (keyType === 'string' || keyType === 'number') {
                        return the._options[key] = val;
                    } else if (keyType === 'object') {
                        data.extend(the._options, key);
                    }
                };
            }

            return property.constructor;
        }
    };
});</code></pre>






	            </div>
	        </section>
	    </div>

    


</div>

<script src="/static/js/jquery.1.10.min.js"> </script>
<script src="/static/js/prettify/prettify.js"> </script>
<script src="/static/js/prettify/lang-css.js"> </script>
<script> prettyPrint(); </script>
<script src="/static/js/linenumber.js"> </script>
<script src="/static/js/bootstrap.js"> </script>
<script src="/static/js/script.js"> </script>

</body>
</html>
