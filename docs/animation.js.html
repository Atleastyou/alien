<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Source: core/dom/animation.js - Alien documents</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <script src="scripts/jquery.1.10.min.js"> </script>
    <link type="text/css" rel="stylesheet" href="css/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="css/bootstrap-theme.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="css/style.css">
</head>

<body>


<div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-header">
      <a class="navbar-brand" href="index.html">Alien documents</a>
    </div>
    <nav role="navigation">
		<ul class="nav navbar-nav">
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
<ul class="dropdown-menu">
<li><a href="xhr.html">core/communication/xhr</a></li>
<li><a href="animation.html">core/dom/animation</a></li>
<li><a href="attribute.html">core/dom/attribute</a></li>
<li><a href="modification.html">core/dom/modification</a></li>
<li><a href="position.html">core/dom/position</a></li>
<li><a href="selector.html">core/dom/selector</a></li>
<li><a href="base.html">core/event/base</a></li>
<li><a href="Emitter.html">core/event/Emitter</a></li>
<li><a href="ready.html">core/event/ready</a></li>
<li><a href="touch.html">core/event/touch</a></li>
<li><a href="compatible.html">core/navigator/compatible</a></li>
<li><a href="hashbang.html">core/navigator/hashbang</a></li>
<li><a href="querystring.html">core/navigator/querystring</a></li>
<li><a href="shell.html">core/navigator/shell</a></li>
<li><a href="ua.html">core/navigator/ua</a></li>
<li><a href="index_.html">ui/drag/index</a></li>
<li><a href="style.html">ui/drag/style</a></li>
<li><a href="data.html">util/data</a></li>
<li><a href="date.html">util/date</a></li>
</ul>
</li>
</ul>
    </nav>
  </div>
</div>


<div id="main">


	

	    <div class="main">
	        <nav id="docs-sidebar">
	            

	            <ul class="nav sidebar-list">
	                

	                

	                

	                
	            </ul>
	        </nav>

	        <section id="docs-content">
	            <div class="content">
		            <h1 class="page-title">Source: core/dom/animation.js</h1>

		            


    

<pre class="prettyprint source"><code>/*!
 * animation.js
 * @author ydr.me
 * @ref https://github.com/visionmedia/move.js
 * 2014-09-20 11:08
 */


define(function (require, exports, module) {
    /**
     * @module core/dom/animation
     * @requires core/dom/attribute
     * @requires util/data
     * @requires core/navigator/compatible
     * @requires core/event/base
     */
    'use strict';

    var attribute = require('./attribute.js');
    var data = require('../../util/data.js');
    var compatible = require('../navigator/compatible.js');
    var event = require('../event/base.js');
    var easingMap = {
        'in': 'ease-in',
        'out': 'ease-out',
        'in-out': 'ease-in-out',
        'snap': 'cubic-bezier(0,1,.5,1)',
        'linear': 'cubic-bezier(.25,.25,.75,.75)',
        'ease-in-quad': 'cubic-bezier(.55,.085,.68,.53)',
        'ease-in-cubic': 'cubic-bezier(.55,.055,.675,.19)',
        'ease-in-quart': 'cubic-bezier(.895,.03,.685,.22)',
        'ease-in-quint': 'cubic-bezier(.755,.05,.855,.06)',
        'ease-in-sine': 'cubic-bezier(.470,0,.745,.715)',
        'ease-in-expo': 'cubic-bezier(.950,.05,.795,.035)',
        'ease-in-circ': 'cubic-bezier(.6,.04,.98,.335)',
        'ease-in-back': 'cubic-bezier(.6,-.28,.735,.045)',
        'ease-out-quad': 'cubic-bezier(.25,.46,.45,.94)',
        'ease-out-cubic': 'cubic-bezier(.215,.61,.355,1)',
        'ease-out-quart': 'cubic-bezier(.165,.84,.44,1)',
        'ease-out-quint': 'cubic-bezier(.23, 1,.32,1)',
        'ease-out-sine': 'cubic-bezier(.39,.575,.565,1)',
        'ease-out-expo': 'cubic-bezier(.19,1,.22,1)',
        'ease-out-circ': 'cubic-bezier(.075,.82,.165,1)',
        'ease-out-back': 'cubic-bezier(.175,.885,.32,1.275)',
        'ease-in-out-quart': 'cubic-bezier(.770,0,.175,1)',
        'ease-in-out-quint': 'cubic-bezier(.860,0,.07,1)',
        'ease-in-out-sine': 'cubic-bezier(.445,.05,.55,.95)',
        'ease-in-out-expo': 'cubic-bezier(1,0,0,1)',
        'ease-in-out-circ': 'cubic-bezier(.785,.135,.15,.86)',
        'ease-in-out-back': 'cubic-bezier(.68,-.55,.265,1.55)'
    };
    var defaults = {
        easing: 'linear',
        duration: 789,
        delay: 0
    };
    var transitionendEventType = 'transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd';
    var noop = function () {
    };

    module.exports = {
        /**
         * 动画
         * @param {HTMLElement|Node} element 元素
         * @param {Object} to 终点
         * @param {Object} [options] 配置
         * @param {String} [options.easing] 缓冲类型，默认为`liner`
         * @param {Number} [options.duration] 动画时间，默认789ms
         * @param {Number} [options.delay] 延迟时间，默认0
         * @param {Function} [callback] 回调
         *
         * @example
         * animation.animate(element, to);
         * animation.animate(element, to, property);
         * animation.animate(element, to, callback);
         * animation.animate(element, to, property, callback);
         */
        animate: function (element, to, options, callback) {
            if (attribute.css(element, 'display') === 'none') {
                return;
            }

            var args = arguments;
            var argL = args.length;
            var keys = [];
            var listener;
            var hasDispatch = 0;
            var easing = '';
            var timeid = 0;

            callback = args[argL - 1];

            if (argL === 3) {
                // .animate(element, to, callback);
                if (data.type(args[2]) === 'function') {
                    options = {};
                }
                // .animate(element, to, property);
                else {
                    callback = noop;
                }
            }
            // .animate(element, to);
            else if (argL === 2) {
                options = {};
                callback = noop;
            }

            listener = function () {
                if (timeid) {
                    clearTimeout(timeid);
                    timeid = 0;
                }

                if (hasDispatch) {
                    return;
                }

                hasDispatch = 1;
                event.un(element, transitionendEventType, listener);
                attribute.css(element, 'transition-duration', '');
                attribute.css(element, 'transition-delay', '');
                attribute.css(element, 'transition-timing-function', '');
                attribute.css(element, 'transition-property', '');
                callback();
            };

            event.on(element, transitionendEventType, listener);
            options = data.extend({}, defaults, options);
            easing = easingMap[options.easing];

            if (!easing) {
                easing = easingMap[defaults.easing];
            }

            data.each(to, function (key) {
                keys.push(key);
            });

            attribute.css(element, 'transition-duration', options.duration + 'ms');
            attribute.css(element, 'transition-delay', options.delay + 'ms');
            attribute.css(element, 'transition-timing-function', easing);
            attribute.css(element, 'transition-property', keys.join(','));

            setTimeout(function () {
                data.each(to, function (key, val) {
                    attribute.css(element, key, val);
                });
            }, 0);

            timeid = setTimeout(listener, options.duration + options.delay + 50);
        }
    };
});</code></pre>






	            </div>
	        </section>
	    </div>

    


</div>


<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
<script src="js/bootstrap.js"> </script>
<script src="js/script.js"> </script>

</body>
</html>
